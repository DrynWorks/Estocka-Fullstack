# ğŸ¢ Estocka - Sistema de GestÃ£o de Estoque

## ğŸ“‹ VisÃ£o Geral

O **Estocka** Ã© um sistema fullstack de gestÃ£o de estoque desenvolvido para controlar produtos, movimentaÃ§Ãµes, categorias e gerar relatÃ³rios analÃ­ticos avanÃ§ados. O sistema implementa controle de acesso baseado em perfis (RBAC) e auditoria completa de aÃ§Ãµes.

---

## ğŸ—ï¸ Arquitetura do Sistema

### Stack TecnolÃ³gico

#### **Backend** ğŸ”§
- **Framework**: FastAPI (Python)
- **ORM**: SQLAlchemy
- **Banco de Dados**: PostgreSQL
- **MigraÃ§Ãµes**: Alembic
- **AutenticaÃ§Ã£o**: JWT (JSON Web Tokens)
- **ValidaÃ§Ã£o**: Pydantic

#### **Frontend** ğŸ¨
- **Framework**: React 18 + TypeScript
- **Build Tool**: Vite
- **Roteamento**: React Router v6
- **UI Components**: shadcn/ui (Radix UI + Tailwind CSS)
- **GrÃ¡ficos**: Recharts
- **RequisiÃ§Ãµes HTTP**: Axios
- **Gerenciamento de Estado**: Context API + Hooks

---

## ğŸ—‚ï¸ Estrutura do Projeto

### Backend (`/backend`)

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ auth/              # AutenticaÃ§Ã£o e autorizaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ auth_controller.py    # Endpoints de login/logout
â”‚   â”‚   â”œâ”€â”€ auth_service.py       # LÃ³gica de autenticaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ jwt_handler.py        # GeraÃ§Ã£o/validaÃ§Ã£o de JWT
â”‚   â”‚
â”‚   â”œâ”€â”€ users/             # GestÃ£o de usuÃ¡rios
â”‚   â”œâ”€â”€ roles/             # GestÃ£o de perfis/permissÃµes
â”‚   â”œâ”€â”€ products/          # CRUD de produtos
â”‚   â”œâ”€â”€ categories/        # CRUD de categorias
â”‚   â”œâ”€â”€ movements/         # MovimentaÃ§Ãµes de estoque
â”‚   â”œâ”€â”€ dashboard/         # Dados do dashboard
â”‚   â”œâ”€â”€ reports/           # RelatÃ³rios analÃ­ticos
â”‚   â”œâ”€â”€ audit/             # Auditoria de aÃ§Ãµes
â”‚   â”‚
â”‚   â”œâ”€â”€ database.py        # ConfiguraÃ§Ã£o do banco
â”‚   â”œâ”€â”€ models.py          # Modelos SQLAlchemy
â”‚   â””â”€â”€ main.py            # Ponto de entrada da API
â”‚
â”œâ”€â”€ alembic/               # MigraÃ§Ãµes de banco
â””â”€â”€ requirements.txt       # DependÃªncias Python
```

### Frontend (`/frontend`)

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/        # Componentes React
â”‚   â”‚   â”œâ”€â”€ ui/           # Componentes base (shadcn)
â”‚   â”‚   â”œâ”€â”€ dashboard/    # Componentes do dashboard
â”‚   â”‚   â””â”€â”€ layout/       # Layout e navegaÃ§Ã£o
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/            # PÃ¡ginas da aplicaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”œâ”€â”€ ProductsPage.tsx
â”‚   â”‚   â”œâ”€â”€ MovementsPage.tsx
â”‚   â”‚   â”œâ”€â”€ ReportsPage.tsx
â”‚   â”‚   â”œâ”€â”€ UsersPage.tsx
â”‚   â”‚   â””â”€â”€ AuditPage.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ services/         # ServiÃ§os de API
â”‚   â”‚   â”œâ”€â”€ api.ts               # Cliente Axios
â”‚   â”‚   â”œâ”€â”€ authService.ts       # AutenticaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ productService.ts    # Produtos
â”‚   â”‚   â”œâ”€â”€ reportService.ts     # RelatÃ³rios
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/         # Contextos React
â”‚   â”‚   â””â”€â”€ AuthContext.tsx      # Contexto de autenticaÃ§Ã£o
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/            # Custom Hooks
â”‚   â”‚   â””â”€â”€ usePermissions.ts    # Hook de permissÃµes
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/            # UtilitÃ¡rios
â”‚   â”‚   â”œâ”€â”€ formatters.ts        # FormataÃ§Ã£o de dados
â”‚   â”‚   â””â”€â”€ exportUtils.ts       # ExportaÃ§Ã£o PDF/CSV
â”‚   â”‚
â”‚   â””â”€â”€ main.tsx          # Ponto de entrada
â”‚
â””â”€â”€ package.json          # DependÃªncias Node
```

---

## ğŸ” Sistema de AutenticaÃ§Ã£o e AutorizaÃ§Ã£o

### AutenticaÃ§Ã£o (JWT)
1. **Login**: UsuÃ¡rio envia email/senha â†’ Backend valida â†’ Retorna token JWT
2. **Token**: Armazenado no `localStorage` do navegador
3. **RequisiÃ§Ãµes**: Token enviado no header `Authorization: Bearer <token>`
4. **Refresh**: Token expira apÃ³s X horas, usuÃ¡rio precisa fazer login novamente

### AutorizaÃ§Ã£o (RBAC - Role-Based Access Control)

#### Perfis de UsuÃ¡rio
- **Admin**: Acesso completo ao sistema
- **Collaborator**: Acesso limitado (sem gerenciar usuÃ¡rios/auditoria)

#### PermissÃµes por MÃ³dulo
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MÃ³dulo      â”‚ Admin â”‚ Collaborator â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard   â”‚  âœ“    â”‚      âœ“       â”‚
â”‚ Produtos    â”‚  âœ“    â”‚      âœ“       â”‚
â”‚ Movimentos  â”‚  âœ“    â”‚      âœ“       â”‚
â”‚ RelatÃ³rios  â”‚  âœ“    â”‚      âœ“       â”‚
â”‚ Categorias  â”‚  âœ“    â”‚      âœ“       â”‚
â”‚ UsuÃ¡rios    â”‚  âœ“    â”‚      âœ—       â”‚
â”‚ Auditoria   â”‚  âœ“    â”‚      âœ—       â”‚
â”‚ Exportar    â”‚  âœ“    â”‚      âœ—       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Multi-tenancy
- Cada usuÃ¡rio pertence a uma **organizaÃ§Ã£o**
- Dados sÃ£o isolados por organizaÃ§Ã£o (usuÃ¡rios de Org A nÃ£o veem dados da Org B)
- Filtros automÃ¡ticos em todas as queries do banco

---

## ğŸ“Š Funcionalidades Principais

### 1. Dashboard ğŸ“ˆ
**O que mostra:**
- KPIs: Total de produtos, movimentaÃ§Ãµes, valor em estoque, categorias
- GrÃ¡ficos:
  - TendÃªncia de vendas (Ãºltimos 30 dias)
  - Top 5 produtos (mais movimentados)
  - DistribuiÃ§Ã£o ABC de produtos
  - Ãšltimas movimentaÃ§Ãµes
- Alertas de produtos com estoque baixo

**Tecnologias:** Recharts para grÃ¡ficos, Cards responsivos

### 2. GestÃ£o de Produtos ğŸ“¦
**Funcionalidades:**
- CRUD completo (Criar, Ler, Atualizar, Deletar)
- Campos: Nome, DescriÃ§Ã£o, SKU, Categoria, PreÃ§o de Custo, PreÃ§o de Venda, Estoque MÃ­nimo, Estoque Atual
- Filtros e busca em tempo real
- Indicadores visuais (estoque baixo em vermelho)

**ValidaÃ§Ãµes:**
- SKU Ãºnico por organizaÃ§Ã£o
- PreÃ§os positivos
- Estoque mÃ­nimo >= 0

### 3. MovimentaÃ§Ãµes de Estoque ğŸ“‹
**Tipos de MovimentaÃ§Ã£o:**
- **Entrada**: Adiciona produtos ao estoque
- **SaÃ­da**: Remove produtos do estoque

**Campos:**
- Produto, Tipo, Quantidade, DescriÃ§Ã£o, Data

**Regras de NegÃ³cio:**
- SaÃ­da nÃ£o pode deixar estoque negativo
- AtualizaÃ§Ã£o automÃ¡tica do estoque do produto
- Registro na auditoria

### 4. RelatÃ³rios AnalÃ­ticos ğŸ“Š

#### Curva ABC
**O que Ã©:** Classifica produtos por importÃ¢ncia no valor consumido
- **Classe A**: ~20% dos produtos = ~80% do valor (foco mÃ¡ximo)
- **Classe B**: ~30% dos produtos = ~15% do valor
- **Classe C**: ~50% dos produtos = ~5% do valor

**VisualizaÃ§Ã£o:** Tabela detalhada + GrÃ¡fico de pizza

#### AnÃ¡lise XYZ
**O que Ã©:** Mede variabilidade da demanda
- **X**: Demanda estÃ¡vel e previsÃ­vel
- **Y**: Demanda moderada
- **Z**: Demanda irregular (requer atenÃ§Ã£o extra)

**CÃ¡lculo:** Coeficiente de VariaÃ§Ã£o (CV) = Desvio PadrÃ£o / MÃ©dia

**VisualizaÃ§Ã£o:** Tabela + GrÃ¡fico de barras horizontais

#### Giro de Estoque
**O que Ã©:** Indica quantas vezes o estoque "gira" no perÃ­odo

**FÃ³rmula:** Giro = Total Vendido / Estoque MÃ©dio

**ClassificaÃ§Ã£o:**
- Alto (>4x): Produtos vendem rÃ¡pido
- MÃ©dio (2-4x): Rotatividade normal
- Baixo (<2x): Produtos parados

**VisualizaÃ§Ã£o:** Tabela + Top 5 em grÃ¡fico de barras

#### PrevisÃ£o de Estoque
**O que faz:** Calcula quando produtos podem faltar

**Campos:**
- Consumo DiÃ¡rio MÃ©dio
- Dias Restantes atÃ© Ruptura
- Ponto de Pedido (quando encomendar)
- Status: CrÃ­tico (<7 dias), Alerta (7-30 dias), OK (>30 dias)

**VisualizaÃ§Ã£o:** Tabela + GrÃ¡fico de status

**ExportaÃ§Ã£o:** Todos os relatÃ³rios podem ser exportados em PDF ou CSV (apenas Admin)

### 5. Categorias ğŸ·ï¸
**Funcionalidades:**
- CRUD de categorias de produtos
- Nome e DescriÃ§Ã£o
- VinculaÃ§Ã£o com produtos

### 6. GestÃ£o de UsuÃ¡rios ğŸ‘¥ (Admin only)
**Funcionalidades:**
- Criar/editar/deletar usuÃ¡rios
- Atribuir perfis (Admin/Collaborator)
- Listar usuÃ¡rios da organizaÃ§Ã£o
- Filtros por perfil e status

### 7. Auditoria ğŸ“ (Admin only)
**O que registra:**
- Todas as aÃ§Ãµes crÃ­ticas: criar, editar, deletar
- Quem fez, quando fez, o que fez, em qual entidade

**Campos do Log:**
- UsuÃ¡rio, AÃ§Ã£o, Entidade, ID da Entidade, Data/Hora, Detalhes (JSON)

**VisualizaÃ§Ã£o:** Tabela paginada com filtros

---

## ğŸ”„ Fluxos do Sistema

### Fluxo de Login
```
1. UsuÃ¡rio acessa /login
2. Digita email/senha
3. Frontend â†’ POST /auth/login
4. Backend valida credenciais
5. Backend gera token JWT
6. Frontend armazena token
7. Redireciona para /dashboard
```

### Fluxo de MovimentaÃ§Ã£o
```
1. UsuÃ¡rio acessa /movimentacoes
2. Clica em "Nova MovimentaÃ§Ã£o"
3. Seleciona produto, tipo (entrada/saÃ­da), quantidade
4. Frontend â†’ POST /movements/
5. Backend valida:
   - Se saÃ­da: estoque suficiente?
   - Quantidade > 0?
6. Backend atualiza estoque do produto
7. Backend registra na auditoria
8. Retorna sucesso
9. Frontend atualiza lista
```

### Fluxo de RelatÃ³rio
```
1. UsuÃ¡rio acessa /relatorios
2. Seleciona aba (ABC, XYZ, Giro, PrevisÃ£o)
3. Frontend â†’ GET /reports/{tipo}
4. Backend calcula mÃ©tricas:
   - ABC: agrupa por valor, ordena, calcula %
   - XYZ: calcula CV de cada produto
   - Giro: total vendido / estoque mÃ©dio
   - PrevisÃ£o: consumo diÃ¡rio, dias restantes
5. Retorna dados processados
6. Frontend exibe em tabela + grÃ¡fico
7. (Opcional) UsuÃ¡rio exporta PDF/CSV
```

---

## ğŸ¨ Interface do UsuÃ¡rio

### Design System
- **Cores:** Tema escuro/claro (toggle automÃ¡tico)
- **Componentes:** shadcn/ui (acessÃ­veis e customizÃ¡veis)
- **Ãcones:** Lucide React
- **Tipografia:** Font system (legÃ­vel e moderna)

### Responsividade
- **Desktop**: Grid de 2-4 colunas
- **Tablet**: Grid de 2 colunas
- **Mobile**: Coluna Ãºnica, menu hambÃºrguer

### NavegaÃ§Ã£o
- **Sidebar**: Menu lateral com links principais
- **Header**: Nome do usuÃ¡rio, toggle tema, logout
- **Breadcrumbs**: LocalizaÃ§Ã£o na aplicaÃ§Ã£o

---

## ğŸ”§ ConfiguraÃ§Ã£o e Deploy

### Requisitos
- Python 3.8+
- Node.js 16+
- PostgreSQL 12+

### Setup Backend
```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
alembic upgrade head
uvicorn app.main:app --reload
```

### Setup Frontend
```bash
cd frontend
npm install
npm run dev
```

### VariÃ¡veis de Ambiente (.env)
```env
# Backend
DATABASE_URL=postgresql://user:pass@localhost/estocka
SECRET_KEY=seu_secret_key_aqui
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# Frontend
VITE_API_URL=http://localhost:8000
```

---

## ğŸš€ Diferenciais do Projeto

1. **Arquitetura Modular**: Backend e frontend bem organizados
2. **TypeScript**: Type safety no frontend
3. **RBAC**: Controle de acesso granular
4. **Multi-tenancy**: Isolamento de dados por organizaÃ§Ã£o
5. **Auditoria Completa**: Rastreabilidade de todas as aÃ§Ãµes
6. **RelatÃ³rios AvanÃ§ados**: ABC, XYZ, Giro, PrevisÃ£o
7. **ExportaÃ§Ã£o**: PDF e CSV
8. **Responsivo**: Funciona em desktop, tablet e mobile
9. **Dark Mode**: Tema escuro/claro
10. **Boas PrÃ¡ticas**: Clean code, componentizaÃ§Ã£o, separaÃ§Ã£o de responsabilidades

---

## ğŸ“ PossÃ­veis Melhorias Futuras

- NotificaÃ§Ãµes em tempo real (WebSockets)
- Dashboard customizÃ¡vel pelo usuÃ¡rio
- IntegraÃ§Ã£o com APIs de fornecedores
- App mobile (React Native)
- Backup automÃ¡tico
- RelatÃ³rios personalizados
- PrevisÃ£o de demanda com Machine Learning

---

## ğŸ“ Tecnologias e Conceitos Demonstrados

### Backend
- API RESTful
- ORM e Migrations
- JWT Authentication
- Dependency Injection
- Service Layer Pattern
- Repository Pattern

### Frontend
- SPA (Single Page Application)
- Component-Based Architecture
- Custom Hooks
- Context API
- Protected Routes
- Data Visualization

### Banco de Dados
- Modelagem Relacional
- Ãndices
- Foreign Keys
- Soft Delete

### DevOps
- Versionamento (Git)
- VariÃ¡veis de Ambiente
- SeparaÃ§Ã£o de ambientes (dev/prod)

---

## ğŸ“ ApresentaÃ§Ã£o - Roteiro Sugerido

1. **IntroduÃ§Ã£o (1 min)**
   - Problema: Empresas precisam controlar estoque
   - SoluÃ§Ã£o: Sistema web completo de gestÃ£o

2. **Demo ao Vivo (5-7 min)**
   - Login
   - Dashboard (mostrar grÃ¡ficos)
   - Cadastrar produto
   - Registrar movimentaÃ§Ã£o
   - Ver relatÃ³rios (ABC + exportar PDF)
   - Mostrar auditoria

3. **Arquitetura (2-3 min)**
   - Mostrar diagrama da stack
   - Backend FastAPI + PostgreSQL
   - Frontend React + TypeScript
   - Explicar JWT e RBAC

4. **Funcionalidades Destaque (2 min)**
   - RelatÃ³rios analÃ­ticos (ABC, XYZ)
   - Multi-tenancy
   - Auditoria
   - Responsivo

5. **ConclusÃ£o (1 min)**
   - Tecnologias modernas
   - Boas prÃ¡ticas
   - EscalÃ¡vel
   - PossÃ­veis melhorias

**Total: 10-15 minutos**
